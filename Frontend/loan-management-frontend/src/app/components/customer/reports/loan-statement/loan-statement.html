<div class="statement-container">

    <!-- Header Section -->
    <div class="header-row">
        <div>
            <h2>Loan Account Statement</h2>
            <p class="subtitle">Track your loan history and payment status</p>
        </div>
        <button mat-flat-button color="primary" (click)="printReport()">
            <mat-icon>print</mat-icon>
            Print Statement
        </button>
    </div>

    <!-- Filter Input -->
    <mat-form-field appearance="outline" class="search-field">
        <mat-label>Search Loans</mat-label>
        <mat-icon matPrefix>search</mat-icon>
        <input matInput (keyup)="applyFilter($event)" placeholder="ByType, ID, or Status #..." #input>
    </mat-form-field>

    <!-- Table Container -->
    <div class="table-card mat-elevation-z4">
        <table mat-table [dataSource]="dataSource" matSort>

            <!-- ID Column -->
            <ng-container matColumnDef="loanId">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Loan ID </th>
                <td mat-cell *matCellDef="let element">
                    <span class="id-badge">#{{element.loanId}}</span>
                </td>
            </ng-container>

            <!-- Type -->
            <ng-container matColumnDef="type">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Type </th>
                <td mat-cell *matCellDef="let element" class="font-medium"> {{element.loanType}} </td>
            </ng-container>

            <!-- Amount -->
            <ng-container matColumnDef="amount">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Principal </th>
                <td mat-cell *matCellDef="let element"> ₹{{element.loanAmount | number}} </td>
            </ng-container>

            <!-- Tenure -->
            <ng-container matColumnDef="tenure">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Tenure </th>
                <td mat-cell *matCellDef="let element"> {{element.tenureMonths}} m </td>
            </ng-container>

            <!-- Paid -->
            <ng-container matColumnDef="paid">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Total Paid </th>
                <td mat-cell *matCellDef="let element" class="highlight-green">
                    ₹{{ (element.totalPaid || 0) | number }}
                </td>
            </ng-container>

            <!-- Outstanding -->
            <ng-container matColumnDef="outstanding">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Balance </th>
                <td mat-cell *matCellDef="let element" class="font-medium">
                    ₹{{ (element.outstandingAmount || 0) | number }}
                </td>
            </ng-container>

            <!-- Status -->
            <ng-container matColumnDef="status">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Status </th>
                <td mat-cell *matCellDef="let element">
                    <span class="status-pill {{element.status?.toLowerCase()}}">
                        {{element.status}}
                    </span>
                </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>

            <!-- No Data Row -->
            <tr class="mat-row" *matNoDataRow>
                <td class="mat-cell" colspan="7">No data matching the filter "{{input.value}}"</td>
            </tr>
        </table>

        <mat-paginator [pageSizeOptions]="[5, 10, 25]" showFirstLastButtons
            aria-label="Select page of loans"></mat-paginator>
    </div>
</div>